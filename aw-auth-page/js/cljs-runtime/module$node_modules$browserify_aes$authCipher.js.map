{
"version":3,
"file":"module$node_modules$browserify_aes$authCipher.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/browserify-aes/authCipher.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$browserify_aes$authCipher\"] = function(global,require,module,exports) {\nvar aes = require('./aes')\nvar Buffer = require('safe-buffer').Buffer\nvar Transform = require('cipher-base')\nvar inherits = require('inherits')\nvar GHASH = require('./ghash')\nvar xor = require('buffer-xor')\nvar incr32 = require('./incr32')\n\nfunction xorTest (a, b) {\n  var out = 0\n  if (a.length !== b.length) out++\n\n  var len = Math.min(a.length, b.length)\n  for (var i = 0; i < len; ++i) {\n    out += (a[i] ^ b[i])\n  }\n\n  return out\n}\n\nfunction calcIv (self, iv, ck) {\n  if (iv.length === 12) {\n    self._finID = Buffer.concat([iv, Buffer.from([0, 0, 0, 1])])\n    return Buffer.concat([iv, Buffer.from([0, 0, 0, 2])])\n  }\n  var ghash = new GHASH(ck)\n  var len = iv.length\n  var toPad = len % 16\n  ghash.update(iv)\n  if (toPad) {\n    toPad = 16 - toPad\n    ghash.update(Buffer.alloc(toPad, 0))\n  }\n  ghash.update(Buffer.alloc(8, 0))\n  var ivBits = len * 8\n  var tail = Buffer.alloc(8)\n  tail.writeUIntBE(ivBits, 0, 8)\n  ghash.update(tail)\n  self._finID = ghash.state\n  var out = Buffer.from(self._finID)\n  incr32(out)\n  return out\n}\nfunction StreamCipher (mode, key, iv, decrypt) {\n  Transform.call(this)\n\n  var h = Buffer.alloc(4, 0)\n\n  this._cipher = new aes.AES(key)\n  var ck = this._cipher.encryptBlock(h)\n  this._ghash = new GHASH(ck)\n  iv = calcIv(this, iv, ck)\n\n  this._prev = Buffer.from(iv)\n  this._cache = Buffer.allocUnsafe(0)\n  this._secCache = Buffer.allocUnsafe(0)\n  this._decrypt = decrypt\n  this._alen = 0\n  this._len = 0\n  this._mode = mode\n\n  this._authTag = null\n  this._called = false\n}\n\ninherits(StreamCipher, Transform)\n\nStreamCipher.prototype._update = function (chunk) {\n  if (!this._called && this._alen) {\n    var rump = 16 - (this._alen % 16)\n    if (rump < 16) {\n      rump = Buffer.alloc(rump, 0)\n      this._ghash.update(rump)\n    }\n  }\n\n  this._called = true\n  var out = this._mode.encrypt(this, chunk)\n  if (this._decrypt) {\n    this._ghash.update(chunk)\n  } else {\n    this._ghash.update(out)\n  }\n  this._len += chunk.length\n  return out\n}\n\nStreamCipher.prototype._final = function () {\n  if (this._decrypt && !this._authTag) throw new Error('Unsupported state or unable to authenticate data')\n\n  var tag = xor(this._ghash.final(this._alen * 8, this._len * 8), this._cipher.encryptBlock(this._finID))\n  if (this._decrypt && xorTest(tag, this._authTag)) throw new Error('Unsupported state or unable to authenticate data')\n\n  this._authTag = tag\n  this._cipher.scrub()\n}\n\nStreamCipher.prototype.getAuthTag = function getAuthTag () {\n  if (this._decrypt || !Buffer.isBuffer(this._authTag)) throw new Error('Attempting to get auth tag in unsupported state')\n\n  return this._authTag\n}\n\nStreamCipher.prototype.setAuthTag = function setAuthTag (tag) {\n  if (!this._decrypt) throw new Error('Attempting to set auth tag in unsupported state')\n\n  this._authTag = tag\n}\n\nStreamCipher.prototype.setAAD = function setAAD (buf) {\n  if (this._called) throw new Error('Attempting to set AAD in unsupported state')\n\n  this._ghash.update(buf)\n  this._alen += buf.length\n}\n\nmodule.exports = StreamCipher\n\n};"],
"names":["shadow$provide","global","require","module","exports","StreamCipher","mode","key","iv","decrypt","Transform","call","h","Buffer","alloc","_cipher","aes","AES","ck","encryptBlock","_ghash","GHASH","length","self","_finID","concat","from","ghash","len","toPad","update","ivBits","tail","writeUIntBE","state","out","incr32","_prev","_cache","allocUnsafe","_secCache","_decrypt","_len","_alen","_mode","_authTag","_called","inherits","xor","prototype","_update","StreamCipher.prototype._update","chunk","rump","encrypt","_final","StreamCipher.prototype._final","Error","tag","final","a","b","Math","min","i","scrub","getAuthTag","StreamCipher.prototype.getAuthTag","isBuffer","setAuthTag","StreamCipher.prototype.setAuthTag","setAAD","StreamCipher.prototype.setAAD","buf"]
}
