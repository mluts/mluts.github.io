{"version":3,"sources":["aw/view/signin.cljs"],"mappings":";AAQA,wBAAA,xBAAMA,wDAAQC,MAAMC;AAApB,AACE,AAAiBA;;AACjB,yEAAA,yDAAA,lIAACC,mDAAMF,MAAMG;;AAEb,GAAI,AAACC,yDAAkB,AAAA,2FAAA,AAAAC,gBAAYL,QAAO,AAAA,0FAAA,AAAAK,gBAAYL;AACpD,AACE,AAACM;;AACD,uCAAA,hCAACC;;AACH,wFAAA,0HAAA,3MAACL,0DAAMF,MAAMQ,0EAAeC;;;AAEhC,sBAAA,tBAAMC;AAAN,AACE,IAAMV,QAAM,gDAAA,2CAAA,yDAAA,pJAACW;AAAb,AACE;AAAA,AAAA,0FAAA,mDAAA,mFAAA,kDAAA,qBAAA,mFAAA,sDAAA,2CAAA,o8CAAA,mFAAA,sDAAA,2CAAA,qDAAA,SAAA,sDAAA,kCAAA,mFAAA,8CAAA,mBAAA,mFAAA,gDAAA,2CAAA,sLAAA,vsEAIgB,AAACC,gDAAQb,sBAAOC,eAE5B,mEAAA,qHAAA,2CAAA,uDAAA,iFAAA,3WAACa,gIAAgCb,0UAEjC,8NAAA,yDAAA,rRAAM,yIAAA,zIAACc,0BAAU,AAAA,uFAAA,AAAAT,gBAAUL,2FACzB,uBAAA,vBAACe,+DACH,mEAAA,oHAAA,2CAAA,qDAAA,4DAAA,uDAAA,iFAAA,3dAACF,+HAAgCb,2oCAIA,4DAAA,5DAACgB","names":["aw.view.signin/submit","state","e","cljs.core.swap_BANG_","cljs.core/assoc","aw.data.user_exists_QMARK_","cljs.core/deref","aw.session/authorize!","aw.route-helpers/redirect!","cljs.core/update","cljs.core/conj","aw.view.signin/view","reagent.core.atom","cljs.core.partial","aw.view.common.keyboard_input","cljs.core/contains?","aw.view.common/error-p","aw.route_helpers.resolve_href"],"sourcesContent":["(ns aw.view.signin\n  (:require\n   [aw.view.common :as common]\n   [aw.route-helpers :as rh]\n   [reagent.core :as r]\n   [aw.session :as session]\n   [aw.data :as data]))\n\n(defn submit [state e]\n  (.preventDefault e)\n  (swap! state assoc :errors #{})\n\n  (if (data/user-exists? (:username @state) (:password @state))\n    (do\n      (session/authorize!)\n      (rh/redirect! :aw/frontpage))\n    (swap! state update :errors conj :password-incorrect)))\n\n(defn view []\n  (let [state (r/atom {:errors #{}})]\n    (fn []\n      [:div\n       [:h1 \"AW Sign-In\"]\n       [:form\n        {:on-submit (partial submit state)}\n\n        (common/keyboard-input :username state {:flags #{:username}})\n\n        (when (contains? (:errors @state) :password-incorrect)\n          (common/error-p \"Username or password incorrect\"))\n        (common/keyboard-input :password state {:type :password\n                                                :flags #{:current-password}})\n\n        [:input {:type \"submit\" :value \"Sign-In\"}]]\n       [:p \"Not registered? \" [:a {:href (rh/resolve-href :aw/signup)} \"Sign-Up\"]]])))\n"]}