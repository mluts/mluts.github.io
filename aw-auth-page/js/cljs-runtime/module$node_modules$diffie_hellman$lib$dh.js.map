{
"version":3,
"file":"module$node_modules$diffie_hellman$lib$dh.js",
"lineCount":7,
"mappings":"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",
"sources":["node_modules/diffie-hellman/lib/dh.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$diffie_hellman$lib$dh\"] = function(global,require,module,exports) {\nvar Buffer = require('buffer').Buffer;\nvar BN = require('bn.js');\nvar MillerRabin = require('miller-rabin');\nvar millerRabin = new MillerRabin();\nvar TWENTYFOUR = new BN(24);\nvar ELEVEN = new BN(11);\nvar TEN = new BN(10);\nvar THREE = new BN(3);\nvar SEVEN = new BN(7);\nvar primes = require('./generatePrime');\nvar randomBytes = require('randombytes');\nmodule.exports = DH;\n\nfunction setPublicKey(pub, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(pub)) {\n    pub = new Buffer(pub, enc);\n  }\n  this._pub = new BN(pub);\n  return this;\n}\n\nfunction setPrivateKey(priv, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(priv)) {\n    priv = new Buffer(priv, enc);\n  }\n  this._priv = new BN(priv);\n  return this;\n}\n\nvar primeCache = {};\nfunction checkPrime(prime, generator) {\n  var gen = generator.toString('hex');\n  var hex = [gen, prime.toString(16)].join('_');\n  if (hex in primeCache) {\n    return primeCache[hex];\n  }\n  var error = 0;\n\n  if (prime.isEven() ||\n    !primes.simpleSieve ||\n    !primes.fermatTest(prime) ||\n    !millerRabin.test(prime)) {\n    //not a prime so +1\n    error += 1;\n\n    if (gen === '02' || gen === '05') {\n      // we'd be able to check the generator\n      // it would fail so +8\n      error += 8;\n    } else {\n      //we wouldn't be able to test the generator\n      // so +4\n      error += 4;\n    }\n    primeCache[hex] = error;\n    return error;\n  }\n  if (!millerRabin.test(prime.shrn(1))) {\n    //not a safe prime\n    error += 2;\n  }\n  var rem;\n  switch (gen) {\n    case '02':\n      if (prime.mod(TWENTYFOUR).cmp(ELEVEN)) {\n        // unsuidable generator\n        error += 8;\n      }\n      break;\n    case '05':\n      rem = prime.mod(TEN);\n      if (rem.cmp(THREE) && rem.cmp(SEVEN)) {\n        // prime mod 10 needs to equal 3 or 7\n        error += 8;\n      }\n      break;\n    default:\n      error += 4;\n  }\n  primeCache[hex] = error;\n  return error;\n}\n\nfunction DH(prime, generator, malleable) {\n  this.setGenerator(generator);\n  this.__prime = new BN(prime);\n  this._prime = BN.mont(this.__prime);\n  this._primeLen = prime.length;\n  this._pub = undefined;\n  this._priv = undefined;\n  this._primeCode = undefined;\n  if (malleable) {\n    this.setPublicKey = setPublicKey;\n    this.setPrivateKey = setPrivateKey;\n  } else {\n    this._primeCode = 8;\n  }\n}\nObject.defineProperty(DH.prototype, 'verifyError', {\n  enumerable: true,\n  get: function () {\n    if (typeof this._primeCode !== 'number') {\n      this._primeCode = checkPrime(this.__prime, this.__gen);\n    }\n    return this._primeCode;\n  }\n});\nDH.prototype.generateKeys = function () {\n  if (!this._priv) {\n    this._priv = new BN(randomBytes(this._primeLen));\n  }\n  this._pub = this._gen.toRed(this._prime).redPow(this._priv).fromRed();\n  return this.getPublicKey();\n};\n\nDH.prototype.computeSecret = function (other) {\n  other = new BN(other);\n  other = other.toRed(this._prime);\n  var secret = other.redPow(this._priv).fromRed();\n  var out = new Buffer(secret.toArray());\n  var prime = this.getPrime();\n  if (out.length < prime.length) {\n    var front = new Buffer(prime.length - out.length);\n    front.fill(0);\n    out = Buffer.concat([front, out]);\n  }\n  return out;\n};\n\nDH.prototype.getPublicKey = function getPublicKey(enc) {\n  return formatReturnValue(this._pub, enc);\n};\n\nDH.prototype.getPrivateKey = function getPrivateKey(enc) {\n  return formatReturnValue(this._priv, enc);\n};\n\nDH.prototype.getPrime = function (enc) {\n  return formatReturnValue(this.__prime, enc);\n};\n\nDH.prototype.getGenerator = function (enc) {\n  return formatReturnValue(this._gen, enc);\n};\n\nDH.prototype.setGenerator = function (gen, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(gen)) {\n    gen = new Buffer(gen, enc);\n  }\n  this.__gen = gen;\n  this._gen = new BN(gen);\n  return this;\n};\n\nfunction formatReturnValue(bn, enc) {\n  var buf = new Buffer(bn.toArray());\n  if (!enc) {\n    return buf;\n  } else {\n    return buf.toString(enc);\n  }\n}\n\n};"],
"names":["shadow$provide","global","require","module","exports","setPublicKey","pub","enc","Buffer","isBuffer","_pub","BN","setPrivateKey","priv","_priv","DH","prime","generator","malleable","setGenerator","__prime","_prime","mont","_primeLen","length","_primeCode","undefined","formatReturnValue","bn","buf","toArray","toString","millerRabin","MillerRabin","TWENTYFOUR","ELEVEN","TEN","THREE","SEVEN","primes","randomBytes","primeCache","Object","defineProperty","prototype","enumerable","get","gen","__gen","hex","join","error","isEven","simpleSieve","fermatTest","test","shrn","mod","cmp","rem","generateKeys","DH.prototype.generateKeys","_gen","toRed","redPow","fromRed","getPublicKey","computeSecret","DH.prototype.computeSecret","other","secret","out","getPrime","front","fill","concat","DH.prototype.getPublicKey","getPrivateKey","DH.prototype.getPrivateKey","DH.prototype.getPrime","getGenerator","DH.prototype.getGenerator","DH.prototype.setGenerator"]
}
