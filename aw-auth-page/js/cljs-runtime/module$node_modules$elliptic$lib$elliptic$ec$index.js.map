{
"version":3,
"file":"module$node_modules$elliptic$lib$elliptic$ec$index.js",
"lineCount":11,
"mappings":"AAAAA,cAAA,CAAA,kDAAA,CAAuE,QAAQ,CAACC,MAAD,CAAQC,OAAR,CAAgBC,MAAhB,CAAuBC,OAAvB,CAAgC,CAa/GC,QAASA,GAAE,CAACC,OAAD,CAAU,CACnB,GAAI,EAAE,IAAF,WAAkBD,GAAlB,CAAJ,CACE,MAAO,KAAIA,EAAJ,CAAOC,OAAP,CAGc,SAAvB,GAAI,MAAOA,QAAX,GACEC,MAAA,CAAOC,MAAOC,CAAAA,SAAUC,CAAAA,cAAeC,CAAAA,IAAhC,CAAqCC,MAArC,CAA6CN,OAA7C,CAAP,CACE,gBADF,CACqBA,OADrB,CAGA,CAAAA,OAAA,CAAUM,MAAA,CAAON,OAAP,CAJZ,CAQIA,QAAJ,WAAuBM,OAAOC,CAAAA,WAA9B,GACEP,OADF,CACY,CAAEQ,MAAOR,OAAT,CADZ,CAGA,KAAKQ,CAAAA,KAAL,CAAaR,OAAQQ,CAAAA,KAAMA,CAAAA,KAC3B,KAAKC,CAAAA,CAAL,CAAS,IAAKD,CAAAA,KAAMC,CAAAA,CACpB,KAAKC,CAAAA,EAAL,CAAU,IAAKD,CAAAA,CAAEE,CAAAA,KAAP,CAAa,CAAb,CACV,KAAKC,CAAAA,CAAL,CAAS,IAAKJ,CAAAA,KAAMI,CAAAA,CAGpB,KAAKA,CAAAA,CAAL,CAASZ,OAAQQ,CAAAA,KAAMI,CAAAA,CACvB,KAAKA,CAAAA,CAAEC,CAAAA,UAAP,CAAkBb,OAAQQ,CAAAA,KAAMC,CAAAA,CAAEK,CAAAA,SAAhB,EAAlB;AAAgD,CAAhD,CAGA,KAAKC,CAAAA,IAAL,CAAYf,OAAQe,CAAAA,IAApB,EAA4Bf,OAAQQ,CAAAA,KAAMO,CAAAA,IA1BvB,CAVrB,IAAIC,GAAKpB,OAAA,CAAQ,wDAAR,CAAT,CACIqB,SAAWrB,OAAA,CAAQ,6CAAR,CACXsB,OAAAA,CAAQtB,OAAA,CAAQ,iDAAR,CACZ,KAAIU,OAASV,OAAA,CAAQ,kDAAR,CAAb,CACIuB,KAAOvB,OAAA,CAAQ,mCAAR,CADX,CAEIK,OAASiB,MAAMjB,CAAAA,MAFnB,CAIImB,QAAUxB,OAAA,CAAQ,kDAAR,CAJd,CAKIyB,UAAYzB,OAAA,CAAQ,wDAAR,CA8BhBC;MAAOC,CAAAA,OAAP,CAAiBC,EAEjBA,GAAGI,CAAAA,SAAUmB,CAAAA,OAAb,CAAuBC,QAAgB,CAACvB,OAAD,CAAU,CAC/C,MAAO,KAAIoB,OAAJ,CAAY,IAAZ,CAAkBpB,OAAlB,CADwC,CAIjDD,GAAGI,CAAAA,SAAUqB,CAAAA,cAAb,CAA8BC,QAAuB,CAACC,IAAD,CAAOC,GAAP,CAAY,CAC/D,MAAOP,QAAQQ,CAAAA,WAAR,CAAoB,IAApB,CAA0BF,IAA1B,CAAgCC,GAAhC,CADwD,CAIjE5B,GAAGI,CAAAA,SAAU0B,CAAAA,aAAb,CAA6BC,QAAsB,CAACC,GAAD,CAAMJ,GAAN,CAAW,CAC5D,MAAOP,QAAQY,CAAAA,UAAR,CAAmB,IAAnB,CAAyBD,GAAzB,CAA8BJ,GAA9B,CADqD,CAI9D5B,GAAGI,CAAAA,SAAU8B,CAAAA,UAAb,CAA0BC,QAAmB,CAAClC,OAAD,CAAU,CAChDA,OAAL,GACEA,OADF,CACY,EADZ,CAIImC,QAAAA,CAAO,IAAIlB,QAAJ,CAAa,CACtBF,KAAM,IAAKA,CAAAA,IADW,CAEtBqB,KAAMpC,OAAQoC,CAAAA,IAFQ,CAGtBC,QAASrC,OAAQqC,CAAAA,OAAjBA,EAA4B,MAHN,CAItBC,QAAStC,OAAQsC,CAAAA,OAAjBA,EAA4BnB,IAAA,CAAK,IAAKJ,CAAAA,IAAKwB,CAAAA,YAAf,CAJN,CAKtBC,WAAYxC,OAAQsC,CAAAA,OAApBE,EAA+BxC,OAAQwC,CAAAA,UAAvCA;AAAqD,MAL/B,CAMtBC,MAAO,IAAKhC,CAAAA,CAAEiC,CAAAA,OAAP,EANe,CAAb,CAWX,KAFA,IAAIC,MAAQ,IAAKlC,CAAAA,CAAEmC,CAAAA,UAAP,EAAZ,CACIC,IAAM,IAAKpC,CAAAA,CAAEqC,CAAAA,GAAP,CAAW,IAAI9B,EAAJ,CAAO,CAAP,CAAX,CACV,CAAA,CAAA,CAAS,CACP,IAAIU,KAAO,IAAIV,EAAJ,CAAOmB,OAAKY,CAAAA,QAAL,CAAcJ,KAAd,CAAP,CACX,IAAI,EAAgB,CAAhB,CAAAjB,IAAKsB,CAAAA,GAAL,CAASH,GAAT,CAAA,CAAJ,CAIA,MADAnB,KAAKuB,CAAAA,KAAL,CAAW,CAAX,CACO,CAAA,IAAKzB,CAAAA,cAAL,CAAoBE,IAApB,CANA,CAhB4C,CA0BvD3B,GAAGI,CAAAA,SAAU+C,CAAAA,YAAb,CAA4BC,QAAqB,CAACC,GAAD,CAAMC,SAAN,CAAiBvC,SAAjB,CAA4B,CAE3E,GAAIE,EAAGsC,CAAAA,IAAH,CAAQF,GAAR,CAAJ,EAAmC,QAAnC,GAAoB,MAAOA,IAA3B,CAA6C,CAC3CA,GAAA,CAAM,IAAIpC,EAAJ,CAAOoC,GAAP,CAAY,EAAZ,CACN,KAAAR,WAAaQ,GAAIR,CAAAA,UAAJ,EAF8B,CAA7C,IAG0B,QAAnB,GAAI,MAAOQ,IAAX,EAELR,UACA,CADaQ,GAAIG,CAAAA,MACjB,CAAAH,GAAA,CAAM,IAAIpC,EAAJ,CAAOoC,GAAP,CAAY,EAAZ,CAHD,GAMDI,GAGJ,CAHUJ,GAAIK,CAAAA,QAAJ,EAGV,CADAb,UACA,CADcY,GAAID,CAAAA,MAClB,CAD2B,CAC3B,GADkC,CAClC,CAAAH,GAAA,CAAM,IAAIpC,EAAJ,CAAOwC,GAAP,CAAY,EAAZ,CATD,CAYkB,SAAzB;AAAI,MAAO1C,UAAX,GACEA,SADF,CAC2B,CAD3B,CACc8B,UADd,CAGY9B,UAAR4C,EAAoB,IAAKjD,CAAAA,CAAEK,CAAAA,SAAP,EACZ,EAAZ,CAAI4C,SAAJ,GACEN,GADF,CACQA,GAAIzC,CAAAA,KAAJ,CAAU+C,SAAV,CADR,CAEA,OAAI,CAACL,SAAL,EAAqC,CAArC,EAAkBD,GAAIJ,CAAAA,GAAJ,CAAQ,IAAKvC,CAAAA,CAAb,CAAlB,CACS2C,GAAIN,CAAAA,GAAJ,CAAQ,IAAKrC,CAAAA,CAAb,CADT,CAGS2C,GA1BkE,CA6B7ErD,GAAGI,CAAAA,SAAUwD,CAAAA,IAAb,CAAoBC,QAAa,CAACR,GAAD,CAAMS,GAAN,CAAWlC,GAAX,CAAgB3B,OAAhB,CAAyB,CACrC,QAAnB,GAAI,MAAO2B,IAAX,GACE3B,OACA,CADU2B,GACV,CAAAA,GAAA,CAAM,IAFR,CAIK3B,QAAL,GACEA,OADF,CACY,EADZ,CAGA,IAAmB,QAAnB,GAAI,MAAOoD,IAAX,EAA8C,QAA9C,GAA+B,MAAOA,IAAtC,EAA0D,CAACpC,EAAGsC,CAAAA,IAAH,CAAQF,GAAR,CAA3D,CAAyE,CACvEnD,MAAA,CAAsB,QAAtB,GAAO,MAAOmD,IAAd,EAAkCA,GAAlC,EAA+D,QAA/D,GAAyC,MAAOA,IAAIG,CAAAA,MAApD,CACE,sEADF,CAEAtD,OAAA,CAAQmD,GAAIG,CAAAA,MAAZ;AAAuB,CAAvB,GAA8BH,GAAIG,CAAAA,MAAlC,CACA,KAAK,IAAIO,EAAI,CAAb,CAAgBA,CAAhB,CAAoBV,GAAIG,CAAAA,MAAxB,CAAgCO,CAAA,EAAhC,CAAqC7D,MAAA,EAAQmD,GAAA,CAAIU,CAAJ,CAAR,CAAiB,GAAjB,IAA0BV,GAAA,CAAIU,CAAJ,CAA1B,CAJkC,CAOzED,GAAA,CAAM,IAAKrC,CAAAA,cAAL,CAAoBqC,GAApB,CAAyBlC,GAAzB,CACNyB,IAAA,CAAM,IAAKF,CAAAA,YAAL,CAAkBE,GAAlB,CAAuB,CAAA,CAAvB,CAA8BpD,OAAQ+D,CAAAA,YAAtC,CAGN9D,OAAA,CAAO,CAACmD,GAAIY,CAAAA,KAAJ,EAAR,CAAqB,iCAArB,CAGIrB,EAAAA,CAAQ,IAAKlC,CAAAA,CAAEmC,CAAAA,UAAP,EACRqB,IAAAA,CAAOJ,GAAIK,CAAAA,UAAJ,EAAiBxB,CAAAA,OAAjB,CAAyB,IAAzB,CAA+BC,CAA/B,CAGPF,EAAAA,CAAQW,GAAIV,CAAAA,OAAJ,CAAY,IAAZ,CAAkBC,CAAlB,CAGZ1C,OAAA,CAAuBkE,CAAf,IAAInD,EAAJ,CAAOyB,CAAP,CAAe0B,EAAAA,EAAhB,CAAmBf,GAAnB,CAAP,CAAgC,sBAAhC,CAGIjB,EAAAA,CAAO,IAAIlB,QAAJ,CAAa,CACtBF,KAAM,IAAKA,CAAAA,IADW,CAEtBuB,QAAS2B,GAFa,CAGtBxB,MAAOA,CAHe,CAItBL,KAAMpC,OAAQoC,CAAAA,IAJQ,CAKtBC,QAASrC,OAAQqC,CAAAA,OAAjBA,EAA4B,MALN,CAAb,CAWX,KAFA,IAAI+B,IAAM,IAAK3D,CAAAA,CAAEqC,CAAAA,GAAP,CAAW,IAAI9B,EAAJ,CAAO,CAAP,CAAX,CAAV,CAESqD,KAAO,CAAhB,CAAA,CAAqBA,IAAA,EAArB,CAA6B,CAC3B,IAAIC;AAAItE,OAAQsE,CAAAA,CAAR,CACNtE,OAAQsE,CAAAA,CAAR,CAAUD,IAAV,CADM,CAEN,IAAIrD,EAAJ,CAAOmB,CAAKY,CAAAA,QAAL,CAAc,IAAKtC,CAAAA,CAAEmC,CAAAA,UAAP,EAAd,CAAP,CACF0B,EAAA,CAAI,IAAKpB,CAAAA,YAAL,CAAkBoB,CAAlB,CAAqB,CAAA,CAArB,CACJ,IAAI,EAAa,CAAb,EAAAA,CAAEC,CAAAA,IAAF,CAAO,CAAP,CAAA,EAAgC,CAAhC,EAAkBD,CAAEtB,CAAAA,GAAF,CAAMoB,GAAN,CAAlB,CAAJ,CAAA,CAGA,IAAII,GAAK,IAAK5D,CAAAA,CAAE6D,CAAAA,GAAP,CAAWH,CAAX,CACT,IAAI,CAAAE,EAAGE,CAAAA,UAAH,EAAJ,CAAA,CAGA,IAAIC,IAAMH,EAAGI,CAAAA,IAAH,EACNC,IAAAA,CAAIF,GAAIG,CAAAA,IAAJ,CAAS,IAAKrE,CAAAA,CAAd,CACR,IAAkB,CAAlB,GAAIoE,GAAEN,CAAAA,IAAF,CAAO,CAAP,CAAJ,GAGIQ,CAEA,CAFIT,CAAEU,CAAAA,IAAF,CAAO,IAAKvE,CAAAA,CAAZ,CAAegE,CAAAA,GAAf,CAAmBI,GAAEJ,CAAAA,GAAF,CAAMZ,GAAIK,CAAAA,UAAJ,EAAN,CAAwBe,CAAAA,IAAxB,CAA6B7B,GAA7B,CAAnB,CAEJ,CADJ2B,CACI,CADAA,CAAED,CAAAA,IAAF,CAAO,IAAKrE,CAAAA,CAAZ,CACA,CAAc,CAAd,GAAAsE,CAAER,CAAAA,IAAF,CAAO,CAAP,CALJ,EAiBA,MATIW,IASG,EATcV,EAAGW,CAAAA,IAAH,EAAUC,CAAAA,KAAV,EAAA,CAAoB,CAApB,CAAwB,CAStC,GAR6B,CAAf,GAAAT,GAAI3B,CAAAA,GAAJ,CAAQ6B,GAAR,CAAA,CAAmB,CAAnB,CAAuB,CAQrC,EALH7E,OAAQqF,CAAAA,SAKL,EALmC,CAKnC,CALkBN,CAAE/B,CAAAA,GAAF,CAAM,IAAKtC,CAAAA,EAAX,CAKlB,GAJLqE,CACA,CADI,IAAKtE,CAAAA,CAAEqC,CAAAA,GAAP,CAAWiC,CAAX,CACJ,CAAAG,GAAA,EAAiB,CAGZ,EAAA,IAAI7D,SAAJ,CAAc,CAAEwD,EAAGA,GAAL,CAAQE,EAAGA,CAAX,CAAcG,cAAeA,GAA7B,CAAd,CAtBP,CAJA,CAL2B,CA3C2B,CA8E1DnF,GAAGI,CAAAA,SAAUmF,CAAAA,MAAb;AAAsBC,QAAe,CAACnC,GAAD,CAAMoC,SAAN,CAAiB3B,GAAjB,CAAsBlC,GAAtB,CAA2B3B,OAA3B,CAAoC,CAClEA,OAAL,GACEA,OADF,CACY,EADZ,CAGAoD,IAAA,CAAM,IAAKF,CAAAA,YAAL,CAAkBE,GAAlB,CAAuB,CAAA,CAAvB,CAA8BpD,OAAQ+D,CAAAA,YAAtC,CACNF,IAAA,CAAM,IAAKhC,CAAAA,aAAL,CAAmBgC,GAAnB,CAAwBlC,GAAxB,CACN6D,UAAA,CAAY,IAAInE,SAAJ,CAAcmE,SAAd,CAAyB,KAAzB,CAGRX,IAAAA,CAAIW,SAAUX,CAAAA,CACdE,UAAAA,CAAIS,SAAUT,CAAAA,CAGlB,IAFgB,CAEhB,CAFIF,GAAEN,CAAAA,IAAF,CAAO,CAAP,CAEJ,EAFsC,CAEtC,EAFqBM,GAAE7B,CAAAA,GAAF,CAAM,IAAKvC,CAAAA,CAAX,CAErB,EAAgB,CAAhB,CAAIsE,SAAER,CAAAA,IAAF,CAAO,CAAP,CAAJ,EAAsC,CAAtC,EAAqBQ,SAAE/B,CAAAA,GAAF,CAAM,IAAKvC,CAAAA,CAAX,CAArB,CACE,MAAO,CAAA,CAGLgF,UAAAA,CAAOV,SAAEC,CAAAA,IAAF,CAAO,IAAKvE,CAAAA,CAAZ,CACPiF,IAAAA,CAAKD,SAAKhB,CAAAA,GAAL,CAASrB,GAAT,CAAc0B,CAAAA,IAAd,CAAmB,IAAKrE,CAAAA,CAAxB,CACLkF,UAAAA,CAAKF,SAAKhB,CAAAA,GAAL,CAASI,GAAT,CAAYC,CAAAA,IAAZ,CAAiB,IAAKrE,CAAAA,CAAtB,CAGT,IAAI,CAAC,IAAKD,CAAAA,KAAMoF,CAAAA,aAAhB,CAEE,MADAC,IACA,CADI,IAAKjF,CAAAA,CAAEkF,CAAAA,MAAP,CAAcJ,GAAd,CAAkB7B,GAAIkC,CAAAA,SAAJ,EAAlB;AAAmCJ,SAAnC,CACJ,CAAIE,GAAEnB,CAAAA,UAAF,EAAJ,CACS,CAAA,CADT,CAGwC,CAHxC,GAGOmB,GAAEjB,CAAAA,IAAF,EAASE,CAAAA,IAAT,CAAc,IAAKrE,CAAAA,CAAnB,CAAsBuC,CAAAA,GAAtB,CAA0B6B,GAA1B,CAMTgB,IAAA,CAAI,IAAKjF,CAAAA,CAAEoF,CAAAA,OAAP,CAAeN,GAAf,CAAmB7B,GAAIkC,CAAAA,SAAJ,EAAnB,CAAoCJ,SAApC,CACJ,OAAIE,IAAEnB,CAAAA,UAAF,EAAJ,CACS,CAAA,CADT,CAMOmB,GAAEI,CAAAA,MAAF,CAASpB,GAAT,CAxCgE,CA2CzE9E,GAAGI,CAAAA,SAAU+F,CAAAA,aAAb,CAA6BC,QAAQ,CAAC/C,GAAD,CAAMoC,SAAN,CAAiBY,CAAjB,CAAoBzE,GAApB,CAAyB,CAC5D1B,MAAA,EAAQ,CAAR,CAAYmG,CAAZ,IAAmBA,CAAnB,CAAsB,0CAAtB,CACAZ,UAAA,CAAY,IAAInE,SAAJ,CAAcmE,SAAd,CAAyB7D,GAAzB,CAERlB,IAAAA,CAAI,IAAKA,CAAAA,CACb,KAAI4F,EAAI,IAAIrF,EAAJ,CAAOoC,GAAP,CACJyB,IAAAA,CAAIW,SAAUX,CAAAA,CAClB,KAAIE,EAAIS,SAAUT,CAAAA,CAAlB,CAGIuB,OAASF,CAATE,CAAa,CACCF,EAAdG,GAAmB,CACvB,IAA8C,CAA9C,EAAI1B,GAAE7B,CAAAA,GAAF,CAAM,IAAKxC,CAAAA,KAAMqF,CAAAA,CAAEf,CAAAA,IAAb,CAAkB,IAAKtE,CAAAA,KAAMC,CAAAA,CAA7B,CAAN,CAAJ,EAAmD8F,CAAnD,CACE,KAAUC,MAAJ,CAAU,sCAAV,CAAN;AAIA3B,GAAA,CADE0B,CAAJ,CACM,IAAK/F,CAAAA,KAAMiG,CAAAA,UAAX,CAAsB5B,GAAE6B,CAAAA,GAAF,CAAM,IAAKlG,CAAAA,KAAMC,CAAAA,CAAjB,CAAtB,CAA2C6F,MAA3C,CADN,CAGM,IAAK9F,CAAAA,KAAMiG,CAAAA,UAAX,CAAsB5B,GAAtB,CAAyByB,MAAzB,CAEFK,UAAAA,CAAOnB,SAAUX,CAAAA,CAAEG,CAAAA,IAAZ,CAAiBvE,GAAjB,CACPmG,EAAAA,CAAKnG,GAAEqC,CAAAA,GAAF,CAAMuD,CAAN,CAAS5B,CAAAA,GAAT,CAAakC,SAAb,CAAmB7B,CAAAA,IAAnB,CAAwBrE,GAAxB,CACLoG,IAAAA,CAAK9B,CAAEN,CAAAA,GAAF,CAAMkC,SAAN,CAAY7B,CAAAA,IAAZ,CAAiBrE,GAAjB,CAIT,OAAO,KAAKG,CAAAA,CAAEkF,CAAAA,MAAP,CAAcc,CAAd,CAAkB/B,GAAlB,CAAqBgC,GAArB,CA3BqD,CA8B9D9G,GAAGI,CAAAA,SAAU2G,CAAAA,mBAAb,CAAmCC,QAAQ,CAACV,CAAD,CAAIb,SAAJ,CAAewB,CAAf,CAAkBrF,GAAlB,CAAuB,CAChE6D,SAAA,CAAY,IAAInE,SAAJ,CAAcmE,SAAd,CAAyB7D,GAAzB,CACZ,IAAgC,IAAhC,GAAI6D,SAAUN,CAAAA,aAAd,CACE,MAAOM,UAAUN,CAAAA,aAEnB,KAASpB,GAAT,CAAa,CAAb,CAAoB,CAApB,CAAgBA,GAAhB,CAAuBA,GAAA,EAAvB,CAA4B,CAE1B,GAAI,CACF,IAAAmD,OAAS,IAAKf,CAAAA,aAAL,CAAmBG,CAAnB,CAAsBb,SAAtB,CAAiC1B,GAAjC,CADP,CAEF,MAAOuC,CAAP,CAAU,CACV,QADU,CAIZ,GAAIY,MAAO9C,CAAAA,EAAP,CAAU6C,CAAV,CAAJ,CACE,MAAOlD,IATiB,CAW5B,KAAU0C,MAAJ,CAAU,sCAAV,CAAN;AAhBgE,CArQ6C;",
"sources":["node_modules/elliptic/lib/elliptic/ec/index.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$elliptic$lib$elliptic$ec$index\"] = function(global,require,module,exports) {\n'use strict';\n\nvar BN = require('bn.js');\nvar HmacDRBG = require('hmac-drbg');\nvar utils = require('../utils');\nvar curves = require('../curves');\nvar rand = require('brorand');\nvar assert = utils.assert;\n\nvar KeyPair = require('./key');\nvar Signature = require('./signature');\n\nfunction EC(options) {\n  if (!(this instanceof EC))\n    return new EC(options);\n\n  // Shortcut `elliptic.ec(curve-name)`\n  if (typeof options === 'string') {\n    assert(Object.prototype.hasOwnProperty.call(curves, options),\n      'Unknown curve ' + options);\n\n    options = curves[options];\n  }\n\n  // Shortcut for `elliptic.ec(elliptic.curves.curveName)`\n  if (options instanceof curves.PresetCurve)\n    options = { curve: options };\n\n  this.curve = options.curve.curve;\n  this.n = this.curve.n;\n  this.nh = this.n.ushrn(1);\n  this.g = this.curve.g;\n\n  // Point on curve\n  this.g = options.curve.g;\n  this.g.precompute(options.curve.n.bitLength() + 1);\n\n  // Hash for function for DRBG\n  this.hash = options.hash || options.curve.hash;\n}\nmodule.exports = EC;\n\nEC.prototype.keyPair = function keyPair(options) {\n  return new KeyPair(this, options);\n};\n\nEC.prototype.keyFromPrivate = function keyFromPrivate(priv, enc) {\n  return KeyPair.fromPrivate(this, priv, enc);\n};\n\nEC.prototype.keyFromPublic = function keyFromPublic(pub, enc) {\n  return KeyPair.fromPublic(this, pub, enc);\n};\n\nEC.prototype.genKeyPair = function genKeyPair(options) {\n  if (!options)\n    options = {};\n\n  // Instantiate Hmac_DRBG\n  var drbg = new HmacDRBG({\n    hash: this.hash,\n    pers: options.pers,\n    persEnc: options.persEnc || 'utf8',\n    entropy: options.entropy || rand(this.hash.hmacStrength),\n    entropyEnc: options.entropy && options.entropyEnc || 'utf8',\n    nonce: this.n.toArray(),\n  });\n\n  var bytes = this.n.byteLength();\n  var ns2 = this.n.sub(new BN(2));\n  for (;;) {\n    var priv = new BN(drbg.generate(bytes));\n    if (priv.cmp(ns2) > 0)\n      continue;\n\n    priv.iaddn(1);\n    return this.keyFromPrivate(priv);\n  }\n};\n\nEC.prototype._truncateToN = function _truncateToN(msg, truncOnly, bitLength) {\n  var byteLength;\n  if (BN.isBN(msg) || typeof msg === 'number') {\n    msg = new BN(msg, 16);\n    byteLength = msg.byteLength();\n  } else if (typeof msg === 'object') {\n    // BN assumes an array-like input and asserts length\n    byteLength = msg.length;\n    msg = new BN(msg, 16);\n  } else {\n    // BN converts the value to string\n    var str = msg.toString();\n    // HEX encoding\n    byteLength = (str.length + 1) >>> 1;\n    msg = new BN(str, 16);\n  }\n  // Allow overriding\n  if (typeof bitLength !== 'number') {\n    bitLength = byteLength * 8;\n  }\n  var delta = bitLength - this.n.bitLength();\n  if (delta > 0)\n    msg = msg.ushrn(delta);\n  if (!truncOnly && msg.cmp(this.n) >= 0)\n    return msg.sub(this.n);\n  else\n    return msg;\n};\n\nEC.prototype.sign = function sign(msg, key, enc, options) {\n  if (typeof enc === 'object') {\n    options = enc;\n    enc = null;\n  }\n  if (!options)\n    options = {};\n\n  if (typeof msg !== 'string' && typeof msg !== 'number' && !BN.isBN(msg)) {\n    assert(typeof msg === 'object' && msg && typeof msg.length === 'number',\n      'Expected message to be an array-like, a hex string, or a BN instance');\n    assert((msg.length >>> 0) === msg.length); // non-negative 32-bit integer\n    for (var i = 0; i < msg.length; i++) assert((msg[i] & 255) === msg[i]);\n  }\n\n  key = this.keyFromPrivate(key, enc);\n  msg = this._truncateToN(msg, false, options.msgBitLength);\n\n  // Would fail further checks, but let's make the error message clear\n  assert(!msg.isNeg(), 'Can not sign a negative message');\n\n  // Zero-extend key to provide enough entropy\n  var bytes = this.n.byteLength();\n  var bkey = key.getPrivate().toArray('be', bytes);\n\n  // Zero-extend nonce to have the same byte size as N\n  var nonce = msg.toArray('be', bytes);\n\n  // Recheck nonce to be bijective to msg\n  assert((new BN(nonce)).eq(msg), 'Can not sign message');\n\n  // Instantiate Hmac_DRBG\n  var drbg = new HmacDRBG({\n    hash: this.hash,\n    entropy: bkey,\n    nonce: nonce,\n    pers: options.pers,\n    persEnc: options.persEnc || 'utf8',\n  });\n\n  // Number of bytes to generate\n  var ns1 = this.n.sub(new BN(1));\n\n  for (var iter = 0; ; iter++) {\n    var k = options.k ?\n      options.k(iter) :\n      new BN(drbg.generate(this.n.byteLength()));\n    k = this._truncateToN(k, true);\n    if (k.cmpn(1) <= 0 || k.cmp(ns1) >= 0)\n      continue;\n\n    var kp = this.g.mul(k);\n    if (kp.isInfinity())\n      continue;\n\n    var kpX = kp.getX();\n    var r = kpX.umod(this.n);\n    if (r.cmpn(0) === 0)\n      continue;\n\n    var s = k.invm(this.n).mul(r.mul(key.getPrivate()).iadd(msg));\n    s = s.umod(this.n);\n    if (s.cmpn(0) === 0)\n      continue;\n\n    var recoveryParam = (kp.getY().isOdd() ? 1 : 0) |\n                        (kpX.cmp(r) !== 0 ? 2 : 0);\n\n    // Use complement of `s`, if it is > `n / 2`\n    if (options.canonical && s.cmp(this.nh) > 0) {\n      s = this.n.sub(s);\n      recoveryParam ^= 1;\n    }\n\n    return new Signature({ r: r, s: s, recoveryParam: recoveryParam });\n  }\n};\n\nEC.prototype.verify = function verify(msg, signature, key, enc, options) {\n  if (!options)\n    options = {};\n\n  msg = this._truncateToN(msg, false, options.msgBitLength);\n  key = this.keyFromPublic(key, enc);\n  signature = new Signature(signature, 'hex');\n\n  // Perform primitive values validation\n  var r = signature.r;\n  var s = signature.s;\n  if (r.cmpn(1) < 0 || r.cmp(this.n) >= 0)\n    return false;\n  if (s.cmpn(1) < 0 || s.cmp(this.n) >= 0)\n    return false;\n\n  // Validate signature\n  var sinv = s.invm(this.n);\n  var u1 = sinv.mul(msg).umod(this.n);\n  var u2 = sinv.mul(r).umod(this.n);\n  var p;\n\n  if (!this.curve._maxwellTrick) {\n    p = this.g.mulAdd(u1, key.getPublic(), u2);\n    if (p.isInfinity())\n      return false;\n\n    return p.getX().umod(this.n).cmp(r) === 0;\n  }\n\n  // NOTE: Greg Maxwell's trick, inspired by:\n  // https://git.io/vad3K\n\n  p = this.g.jmulAdd(u1, key.getPublic(), u2);\n  if (p.isInfinity())\n    return false;\n\n  // Compare `p.x` of Jacobian point with `r`,\n  // this will do `p.x == r * p.z^2` instead of multiplying `p.x` by the\n  // inverse of `p.z^2`\n  return p.eqXToP(r);\n};\n\nEC.prototype.recoverPubKey = function(msg, signature, j, enc) {\n  assert((3 & j) === j, 'The recovery param is more than two bits');\n  signature = new Signature(signature, enc);\n\n  var n = this.n;\n  var e = new BN(msg);\n  var r = signature.r;\n  var s = signature.s;\n\n  // A set LSB signifies that the y-coordinate is odd\n  var isYOdd = j & 1;\n  var isSecondKey = j >> 1;\n  if (r.cmp(this.curve.p.umod(this.curve.n)) >= 0 && isSecondKey)\n    throw new Error('Unable to find sencond key candinate');\n\n  // 1.1. Let x = r + jn.\n  if (isSecondKey)\n    r = this.curve.pointFromX(r.add(this.curve.n), isYOdd);\n  else\n    r = this.curve.pointFromX(r, isYOdd);\n\n  var rInv = signature.r.invm(n);\n  var s1 = n.sub(e).mul(rInv).umod(n);\n  var s2 = s.mul(rInv).umod(n);\n\n  // 1.6.1 Compute Q = r^-1 (sR -  eG)\n  //               Q = r^-1 (sR + -eG)\n  return this.g.mulAdd(s1, r, s2);\n};\n\nEC.prototype.getKeyRecoveryParam = function(e, signature, Q, enc) {\n  signature = new Signature(signature, enc);\n  if (signature.recoveryParam !== null)\n    return signature.recoveryParam;\n\n  for (var i = 0; i < 4; i++) {\n    var Qprime;\n    try {\n      Qprime = this.recoverPubKey(e, signature, i);\n    } catch (e) {\n      continue;\n    }\n\n    if (Qprime.eq(Q))\n      return i;\n  }\n  throw new Error('Unable to find valid recovery factor');\n};\n\n};"],
"names":["shadow$provide","global","require","module","exports","EC","options","assert","Object","prototype","hasOwnProperty","call","curves","PresetCurve","curve","n","nh","ushrn","g","precompute","bitLength","hash","BN","HmacDRBG","utils","rand","KeyPair","Signature","keyPair","EC.prototype.keyPair","keyFromPrivate","EC.prototype.keyFromPrivate","priv","enc","fromPrivate","keyFromPublic","EC.prototype.keyFromPublic","pub","fromPublic","genKeyPair","EC.prototype.genKeyPair","drbg","pers","persEnc","entropy","hmacStrength","entropyEnc","nonce","toArray","bytes","byteLength","ns2","sub","generate","cmp","iaddn","_truncateToN","EC.prototype._truncateToN","msg","truncOnly","isBN","length","str","toString","delta","sign","EC.prototype.sign","key","i","msgBitLength","isNeg","bkey","getPrivate","eq","ns1","iter","k","cmpn","kp","mul","isInfinity","kpX","getX","r","umod","s","invm","iadd","recoveryParam","getY","isOdd","canonical","verify","EC.prototype.verify","signature","sinv","u1","u2","_maxwellTrick","p","mulAdd","getPublic","jmulAdd","eqXToP","recoverPubKey","EC.prototype.recoverPubKey","j","e","isYOdd","isSecondKey","Error","pointFromX","add","rInv","s1","s2","getKeyRecoveryParam","EC.prototype.getKeyRecoveryParam","Q","Qprime"]
}
